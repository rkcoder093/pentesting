# **SMTP**

*It stand for Simple mail transfer protocol used to send the mail over the id, mainly it is used with the IMAP or POP3 protocla to fetch and sends email it is client-servar-based-protocol*

**PORT**

- *`25` - this is common port.*
- *`587` - this port is also used by the SMTP servrer this port is used to recive email form the authoncited users.*

*SMTP works unencrypted  so it transmit all commands, data, or authontication information in the paintext over the network, to privent this SMTP use the conjunction with **SSL/TLS** encryption. Under certain circumstances, a server uses a port other than the standard like `465`*

**Mail User Agent (MUA)**

- it is used by the sender to  composed, read and send emails.
- sender sends the email, MAU communicat to the SMTP server to send the message.

**Mail Transfer Agent (MTA)**

- *it is responsible for routing and delivering email messages on the server side.*
- *MTA che the mail for spam size and other factors when it recive the mail form the SMTP server.*
- *MTA stores the email in the recipient's mailbox for retrieval*
- *it preform DNS Lookup to fimd the sender ip address to determine the route for delivering the email to the recipient's mailbox.*

**Mail Submission Agent (MSA)**

- *it also act as a relay server, it validate or authonticate the sender emain before forwading to the MTA.*

**Open Relay Attack**

*open relay is an SMTP server that allow the anyone on internet send email though this server, whether the user is authorized or not,, Attackers exploit Open Relays to send large volumes of spam emails, often using the server's resources and reputation. to prevint this SMTP servers should be properly configured to only accept emails from authorized users or from trusted sources.*

**Disadvantage of the SMTP**

1. *sending an email using SMTP does not return a usable delivery confirmation*
2. user are not authenticated when the connection is established.

*For this purpose the Extended SMTP is developed. ESMTP uses TLS. which is done after the EHLO command by sending STARTTLS. from this moment on, the entire connection is encrypted. Now AUTH PLAIN extension for authentication can also be used safely.*

`telnet tool to initialize a TCP connection with the SMTP server.`

# **IMPA/POP3**

###### `IMAP - Internet Message Access Protocol`

###### `POP3 - Post Office Protocol`

*port -*  `110, 143, 993` and `995` *two higher port is used for SSL/TLS to encrypt the connextion*

*with the help the IMAP used to access to emails from a mail server is possible.*

**To interact with IMAP or POP3 over SSL we use openssl or ncat**

`openssl s_client -connect <ip_address>:pop3s`

`openssl s_client -connect <ip_address>:imaps`

#### IMAP Commands

| **command** | **description** |
|-----------|-----------|
|`tag LOGIN username password` | *User Login*
|`tag LIST "" *`|*List all directories*|
| `tag CREATE "INBOX"`| *Creates a mailbox with a specified name.*|
| `DELETE "INBOX"` | *delete the mailbox*|
| `tag RENAME "ToRead" "Important"` | *remain the inbox*|
|`tag LSUB "" *` | *Returns a subset of names from the set of names that the User has declared as being active or subscribed.*| 
|`tag SELECT INBOX` | *Select the mailbox, than access the mails*|
|`tag UNSELECT INBOX` | *Exit the selected mail box*|
|`tag FETCH <ID> all` | *Retrieves data associated with a message in the mailbox*|
|`tag CLOSE` | *Removes all messages with the `Deleted` flag set.* |
|`tag LOGOUT` |*Closes the connection with the IMAP server.*|

#### POP3 Commands
| **command** | **description** |
|-----------|-----------|
|`USER username`|*Identifies the user.*|
|`PASS password`	|*Authentication of the user using its password.*|
|`STAT`	|*Requests the number of saved emails from the server*|
|`LIST`	|*Requests from the server the number and size of all emails.*|
|`RETR id`	| *Requests the server to deliver the requested email by ID.*|
|`DELE id`	| *Requests the server to delete the requested email by ID.*|
|`CAPA`	| *Requests the server to display the server capabilities.*|
|`RSET`	| *Requests the server to reset the transmitted information.*|
|`QUIT`	| *Closes the connection with the POP3 server.*|

# **SNMP**

*Simple Network Managment Protocol was created to monitor network devices. In addition, this protocol can also be used to handle configuration tasks and change settings remotely.
addressing mechanism is an absolute prerequisite for  successfully transmitting data and network monitoring using SNMP.*

**Port -** `161` *use to send controls command. Always the client who actively requests information from the server, SNMP also enables the use of so-called traps over UDP port `162`.*

**MIB** *Managment Information Base works acress the manufacturers and client-server combinations, independent formate to sotre the information, used the standardized tree hierarchy way yo list the devices. file writen in Abstract syntes nitation one based oh ASCII text format. it does not contain data but it expalin where to find which information and what it liikes like. return the OID or data type used.*

**OID** * represents a node in a hierarchical namespace. nodes identified by the sequesnce of number, it determint he postition on the tree longer the chain more specific the information.*

**Tool to enum -** 

*`snmpwalk`* **- it is used to query the OIDs with thier informations `snmpwalk -v2c -c public <ip_address>`**

*`onesixtyone`* **- used to brute-force the names of the community strings since they can be named arbitrarily by the administrator**

**Install onesixone**

    sudo apt install onesixtyone
**use**

    onesixtyone -c <file_name> <ip_address>

*Once we know a community string, we can use it with braa to brute-force the individual OIDs and enumerate the information behind them.*

*`braa`* 

**Install braa**

    sudo apt install braa

**Syntex**

    braa <community string>@<IP>:.1.3.6.*

**Note -** *For makeing our own wordlist use the tool `crunch`*


# **MySQL**
*MySQL is an open-source SQL relational database management system developed and supported by Oracle. A database is simply a structured collection of data organized for easy use and retrieval.*

*MySQL clients can retrieve and edit the data using structured queries to the database engine. Inserting, deleting, modifying, and retrieving data, is done using the SQL database language.*

**Port -** `3306`

**Install**

    sudo apt install mysql-server -y

**Login in to MySQL DB**

    mysql -u <user> -p<password> -h <IP address>

| **Command** | **discription** |
|-----|----------|
|`show databases;`	|*Show all databases.*|
|`use <database>;`	|*Select one of the existing databases.*|
|`show tables;`|*Show all available tables in the selected database.*|
|`show columns from <table>;`|*Show all columns in the selected database.*|
|`select * from <table>;`|	*Show everything in the desired table.*|
|`select * from <table> where <column> = "<string>";`|*	Search for needed string in the desired table.*|

# **MSSQL**

*Microsoft's SQL-based relational database management system. MSSQL is closed source and was initially written to run on Windows operating systems. It is popular among database administrators and developers when building applications that run on Microsoft's .NET framework due to its strong native support for .NET*

**Port -** `1444`

*SQL Server Management Studio - it is a client side application server for initial configuration and long-term management of databases by admins.*

*Many other clients can be used to access a database running on MSSQL. such as:` mssql-cli`	`SQL Server PowerShell`	`HeidiSQL`	`SQLPro`,	`Impacket's mssqlclient.py`*

# **Oracle Transparent Network Substrate  (TNS)**

*server is a communication protocol that facilitates communication between Oracle databases and applications over networks. In addition, its built-in encryption mechanism ensures the security of data transmitted*

**Port -** `1521`

*Oracle Database Attacking Tool (ODAT) is an open-source penetration testing tool written in Python and designed to enumerate and exploit vulnerabilities in Oracle databases.*

**tootl to enumurate the SID for the oracle databse ` nmap` ` hydra` `odat`**

*steps to enumurate* `nmap`*to find the sid or string* `odat` *to enumurate further to gether information such as username or password*  *`sqlplus` to get interact with the database.*

# **IPMI**
*Intelligent Platform Management Interface (IPMI) is a set of standardized specifications for hardware-based host management systems used for system management and monitoring.IPMI can monitor a range of different things such as system temperature, voltage, fan status, and power supplies,  querying inventory information, reviewing hardware logs, and alerting using SNMP.*

*IPMI is typically used in three ways:*

1. *Before the OS has booted to modify BIOS settings*
2. *When the host is fully powered down*
3. *Access to a host after a system failure*

*PORT-* `623`

*Baseboard Management Controllers (BMCs).  Gaining access to a BMC is nearly equivalent to physical access to a system.*

# ***Remote Controll Managment***
### **Linux:** 
#### ***SSH*** 
*Secure Shell (SSH) enables two computers to establish an encrypted and direct connection within a possibly insecure network on the standard port TCP 22.*

###### *OpenSSH has six different authentication methods:*

1. **Password authentication -** * users have to enter the password every time they log on to another server during the same session.*
2. **Public-key authentication -** *client-side authentication is the use of a public key and private key pair.*
3. **Host-based authentication -**
4. **Keyboard authentication -**
5. **Challenge-response authentication -**
6. **GSSAPI authentication -**

*`Rsync` is a fast and efficient tool for locally and remotely copying files. It can be used to copy files locally on a given machine and to/from remote hosts. It is highly versatile and well-known for its delta-transfer algorithm.*

*`R-Services` are a suite of services hosted to enable remote access or issue commands between Unix hosts over TCP/IP.*


### **WINDOWS**
1. *Remote Desktop Protocol (RDP)*
2. *Windows Remote Management (WinRM)*
3. *Windows Management Instrumentation (WMI)*

#### ***RDP***

**connect to RDP servers on Linux using `xfreerdp` `rdesktop` `Remmina`**


**xfreerdp**

    xfreerdp /u:{username} /p:"{password}" /v:{ip_address}

#### **RDP**
*The Remote Desktop Protocol (RDP) is a protocol developed by Microsoft for remote access to a computer running the Windows operating system. This protocol allows display and control commands to be transmitted via the GUI encrypted over IP networks.*

**PORT -** `3389`
#### ***WinRM***
*The Windows Remote Management (WinRM) is a simple Windows integrated remote management protocol based on the command line. TCP port `5985` `5986`*

*WinRM for administration is Windows Remote Shell (WinRS), which lets us execute arbitrary commands on the remote system.*

` evil-winrm` *design to interact with the WinRM*

    evil-winrm -i <ip_address> -u username -p <password>

#### **WMI**
*Windows Management Instrumentation (WMI) is Microsoft's implementation and also an extension of the Common Information Model (CIM), it allow toe read and rigth all the settings on windows system. Accessed via PowerShell, VBScript, or the Windows Management Instrumentation Console (WMIC). TCP port `135`*

**WMIexec.py (For FootPrinting)**

    /usr/share/doc/python3-impacket/examples/wmiexec.py <username>:"<password>"@<ipaddress> "hostname"


# **Information gathering Web-Version**

- **first step in every penetration test**
- **This phase helps us understand the attack surface, technologies used, and, in some cases, discover development environments**
- **by enumeration domain and subdomain, infrastructure, ip range, virtual hosts.**

## **Type of information gathering process**
1. **passive information gathering -**  * do not interact directly with the target Instead, we collect publicly available information using search engines, whois, certificate information, etc.*
2. **active information gathering -** *directly interact with the target with Some of the techniques used include port scanning, DNS enumeration, directory brute-forcing, virtual host enumeration, and web application crawling/spidering.*

## **WHOIS**
*`WHOIS` domain lookups allow us to retrieve information about the domain name of an already registered domain.*
*online ` whois.domaintools.com` or tool `whois` *

*whois Example. *

    whois facebook.com

## **DNS**
*DNS is the Internet's phone book.*

**`NSLOOKUP`**

    nslookup <domain_name>  //this will query the A records only

**`DIG`**

    dig <domain_name> @ip_address // this gives much info.

**query a records**

    dig a <domain_name> @<ip> //query the A record
    dig -x <domain_name> @<ip> //query the PTR records
    dig any <domain_name> @<ip> //query the ANY records
    dig txt <domain_name> @<ip> //query the txt records
 

    nslookup -query=A <domain_name>  // query the A records
    nslookup -query=PTR <domain_name> //query the PTR records
    nslookup -query=ANY <domain_name> //query the anhy records
    nslookup -query=TXT <domain_name> //query the txt records

## **Subdomain enumuration**
#### **Passive**
1. `VirusTotal` //website
2. [certificate](https://censys.io)
3. [certificate](https://crt.sh)
4. `curl`
5. `openss6l`
6. `theHarvester`

**curl**

    curl -s "https://crt.sh/?q=${TARGET}&output=json" | jq -r '.[] | "\(.name_value)\n\(.common_name)"' | sort -u > "${TARGET}_crt.sh.txt"

openSSL 

    openssl s_client -ign_eof 2>/dev/null <<<$'HEAD / HTTP/1.0\r\n\r' -connect "${TARGET}:${PORT}" | openssl x509 -noout -text -in - | grep 'DNS' | sed -e 's|DNS:|\n|g' -e 's|^\*.*||g' | tr -d ',' | sort -u

`TheHarvester` *tool collects emails, names, subdomains, IP addresses, and URLs from various public data sources*

    cat sources.txt | while read source; do theHarvester -d "${TARGET}" -b $source -f "${source}_${TARGET}";done

*source.txt*

    baidu
    bufferoverun
    crtsh
    hackertarget
    otx
    projectdiscovery
    rapiddns
    sublist3r
    threatcrowd
    trello
    urlscan
    vhost
    virustotal
    zoomeye

*after finished extract all the subdomain and sort*
    
    cat *.json | jq -r '.hosts[]' 2>/dev/null | cut -d':' -f 1 | sort -u > "${TARGET}_theHarvester.txt"

*merge all the passive reconnaissance files*

    cat facebook.com_*.txt | sort -u > facebook.com_subdomains_passive.txt

    cat facebook.com_subdomains_passive.txt | wc -l
#### **Active**

**Zone Transfer**
*website*

    https://hackertarget.com/zone-transfer/

*manual*

    nslookup -type=NS zonetransfer.me

*Testing for ANY and AXFR Zone Transfer*

    nslookup -type=any -query=AXFR zonetransfer.me nsztm1.digi.ninja

*Gobuster*

    gobuster dns -q -r "${NS}" -d "${TARGET}" -w "${WORDLIST}" -p ./patterns.txt -o "gobuster_${TARGET}.txt"






## **infrastructure enum**
#### **Passive**
[NETCRAFT](https://sitereport.netcraft.com)

[Wayback Machine](http://web.archive.org/)

[WayBackURLS](https://github.com/tomnomnom/waybackurls)

#### **Active**
*Web servers-* `curl` `Apache` `Nginx` `Microsoft IIS`

*HTTP Header Tools* - `whatweb` `Wappalyzer` `WafW00f` `Aquatone`

    whatweb -a3 https://www.facebook.com -v

**install WafW00f** *it is firewall for fingure printing, that sends request and analyze then fro security solution in peace*

    sudo apt install wafw00f -y

**use:**

    wafw00f -v https://www.tesla.com

**install Aquatone**

    sudo apt install golang chromium-driver
    go get github.com/michenriksen/aquatone
    export PATH="$PATH":"$HOME/go/bin"
**subdomain list and pipe the command to aquatone**

    cat facebook_aquatone.txt | aquatone -out ./aquatone -screenshot-timeout 1000

## **Virtual hosts**
*A virtual host (vHost) is a feature that allows several websites to be hosted on a single server*
1. IP-based virtual hosting *that different servers can be addressed under different IP addresses on this host.*
2. Name-based virtual hosting *diffrent domain  refer to the same IP, and Internally on the server, these are separated and distinguished using different folders.*

*Note- subdomains having the same IP address that can either be virtual hosts or, in some cases, different servers sitting behind a proxy.*

#### **curl** 

    curl -s http://<ip_address> -H "Host: dev-admin.randomtarget.com"

**find vhost using fuff**

    ffuf -w /usr/share/seclists/Discovery/DNS/namelist.txt  -H "Host: FUZZ.<domain_name>" -u http://<ip> -mr "<regexp>" -fs 10918 -mc 200

#### **MATCHER OPTIONS:**
|**options** | **description**|
|-------|-----------|
  `-mc`              |   *Match HTTP status codes, or "all" for everything. (default: 200,204,301,302,307,401,403,405)*
  `-ml`              |   *Match amount of lines in response*
  `-mr`              |   *Match regexp*
  `-ms`              |   *Match HTTP response size*
  `-mw`              |  *Match amount of words in response*
#### **FILTER OPTIONS:**
|**options** | **description**|
|----|--|
  `-fc`             |    *Filter HTTP status codes from response. Comma separated list of codes and ranges*
  `-fl`             |    *Filter by amount of lines in response. Comma separated list of line counts and ranges*
  `-fr`             |   *Filter regexp*
  `-fs`             |    *Filter HTTP response size. Comma separated list of sizes and ranges*
  `-fw`             |    *Filter by amount of words in response. Comma separated list of word counts and ranges*

## **Crawling**
*Crawling a website is the systematic or automatic process of exploring a website*
1. `burp sute` / `zap` (opensource)
2. `ffuf`

**ffuf enumiurate recursively**

    ffuf -recursion -recursion-depth 1 -u http://<>ip_address/FUZZ -w /opt/useful/SecLists/Discovery/Web-Content/raft-small-directories-lowercase.txt

*attack for folder or file*

    ffuf -w ./folders.txt:FOLDERS,./wordlist.txt:WORDLIST,./extensions.txt:EXTENSIONS -u http://192.168.10.10/FOLDERS/WORDLISTEXTENSIONS

**Note -** *create the word list front tool called `CeWL`*
    
    cewl -m5 --lowercase -w wordlist.txt http://192.168.10.10


# ***HASHING vs ENCRYPTION***
### **Hashing**
- *Hashing is the process of converting some text to a string, which is unique to that particular text*
- *Hashing is a one-way process, meaning there is no way of reconstructing the original plaintext from a hash*

    echo -n "p@ssw0rd" | md5sum

### **Encryption**
- *Encryption is a process make it's possible to decrypt the ciphertext (encrypted data) and obtain the original content.*
#### ***Type***
1. **Symmetric -** *Symmetric algorithms use a key or secret to encrypt the data and use the same key to decrypt it*
2. **Asymmetric -** *asymmetric algorithms divide the key into two parts (i.e., public and private). The public key can be given to anyone who wishes to encrypt some information and pass it securely to the owner. The owner then uses their private key to decrypt the content.*


