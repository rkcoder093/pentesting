|**Command**|	**Description**|
|-|-|
|pip install hashid|	Install the hashid tool|
|hashid <hash> OR hashid <hashes.txt>|	Identify a hash with the hashid tool|
|hashcat --example-hashes|	View a list of Hashcat hash modes and example hashes|
|hashcat -b -m <hash mode>|	Perform a Hashcat benchmark test of a specific hash mode|
|hashcat -b|	Perform a benchmark of all hash modes|
|hashcat -O|	Optimization: Increase speed but limit potential password length|
|hashcat -w 3|	Optimization: Use when Hashcat is the only thing running, use 1 if running hashcat on your desktop. Default is 2|
|hashcat -a 0 -m <hash type> <hash file> <wordlist>	|Dictionary attack|
|hashcat -a 1 -m <hash type> <hash file> <wordlist1> <wordlist2>	|Combination attack|
|hashcat -a 3 -m 0 <hash file> -1 01 'ILFREIGHT?l?l?l?l?l20?1?d'|	Sample Mask attack|
|hashcat -a 7 -m 0 <hash file> -1=01 '20?1?d' rockyou.txt|	Sample Hybrid attack|
|crunch <minimum length> <maximum length> <charset> -t <pattern> -o <output file>|	Make a wordlist with Crunch|
|python3 cupp.py -i|	Use CUPP interactive mode|
kwp -s 1 basechars/full.base keymaps/en-us.keymap routes/2-to-10-max-3-direction-changes.route	|Kwprocessor |example|
|cewl -d <depth to spider> -m <minimum word length> -w <output wordlist> <url of website>	|Sample CeWL command|
|hashcat -a 0 -m 100 hash rockyou.txt -r rule.txt	|Sample Hashcat rule syntax|
|./cap2hccapx.bin input.cap output.hccapx	|cap2hccapx syntax|
|hcxpcaptool -z pmkidhash_corp cracking_pmkid.cap	|hcxpcaptoolsyntax|

# **HASHCAT**
`Hashcat` *is a popular open-source password cracking tool.*

*install hashcat*

    sudo apt install hashcat

*help*

    hashcat -h

*type:* `-a` and `-m` for mode

|**#**|	**Mode**| **command**|
|-|-|-|
|0|	*Straight attack reads from a wordlist and tries to crack the supplied hashes*| `hashcat -a 0 -m <hash type> <hash file> <wordlist>`|
|1|	*Combination -  combine the two word from the two diffrent files*| `hashcat -a 1 -m <hash type> <hash file> <wordlist1> <wordlist2>`
|3|	Brute-force| `hashcat -a 3 -m <hash_mode> <file> -1 02 <wordlist> `
|6|	*Hybrid Wordlist + Mask*| `hashcat -a 6 -m 0 hybrid_hash <word_list> '?d?s'`
|7|	Hybrid Mask + Wordlist| `hashcat -a 7 -m 0 hybrid_hash_prefix -1 01 '20?1?d' <wordlist>`

**Mask -**
*Mask attacks are used to generate words matching a specific pattern.This type of attack is particularly useful when the password length or format is known.*

Placeholder	|Meaning
|-|-|
?l|	lower-case ASCII letters (a-z)
?u|	upper-case ASCII letters (A-Z)
?d|	digits (0-9)
?h|	0123456789abcdef
?H|	0123456789ABCDEF
?s|	special characters («space»!"#$%&'()*+,-./:;<=>?@[]^_`{
?a|	?l?u?d?s
?b|	0x00 - 0xff

*examples*

    hashcat --example-hashes | less

check beanchmark -b

    hashcat -b -m 0

*check the combination of the words*

    hashcat -a 1 --stdout file1 file2

# **Creating Custom Wordlists**
## *CRUNCH*
*Install*

    sudo apt install crunch

*how to use it*

    crunch <minimum length> <maximum length> <charset> -t <pattern> -o <output file>

**Note -** * "-t" option is used to specify the pattern for generated passwords. The pattern can contain "@," representing lower case characters, "," (comma) will insert upper case characters, "%" will insert numbers, and "^" will insert symbols.*

## *CUPP*

    cupp.py -i

## *KWPROCESSOR*

*installation*

    git clone https://github.com/hashcat/kwprocessor
    cd kwprocessor
    make

*Example*
    
    kwp -s 1 basechars/full.base keymaps/en-us.keymap  routes/2-to-10-max-3-direction-changes.route

## *Princeprocessor (PRINCE)*

*Install*

    wget https://github.com/hashcat/princeprocessor/releases/download/v0.22/princeprocessor-0.22.7z
    7z x princeprocessor-0.22.7z
    cd princeprocessor-0.22
    ./pp64.bin -h

`./pp64.bin --keyspace < words` *`--keyspace` is use to fine the number of combination from the words in the file words.*

*Making wordlist*

    ./pp64.bin -o wordlist.txt < words

*controll the words lenght*

    ./pp64.bin --pw-min=10 --pw-max=25 -o wordlist.txt < words  

*The number of elements per word can be controlled using "--elem-cnt-min" and "--elem-cnt-max".*

    ./pp64.bin --elem-cnt-min=3 -o wordlist.txt < words eg: dogdogdog

## **CeWL**

    cewl -d <depth to spider> -m <minimum word length> -w <output wordlist> <url of website>
    
    example:
    cewl -d 5 -m 8 -e http://inlanefreight.com/blog -w wordlist.txt


1.  hashcat stores all cracked passwords in the hashcat.potfile file; the format is hash:password.
2. The Hashcat-utils repo contains many utilities that can be useful for more advanced password cracking. The tool maskprocessor

## Working with Rules
*rules such as prefixing, suffixing, toggling case, cutting, reversing, and much more.*

|**Function**|	**Description**|	**Input**|	**Output**|
|-|-|-|-|
l|	Convert all letters to lowercase|	InlaneFreight2020 |	inlanefreight2020
u|	Convert all letters to uppercase|	InlaneFreight2020|	INLANEFREIGHT2020
c / C	|capitalize / lowercase first letter and invert the rest|	inlaneFreight2020 / Inlanefreight2020|	Inlanefreight2020 / iNLANEFREIGHT2020
t / TN	|Toggle case : whole word / at position N|	InlaneFreight2020|	iNLANEfREIGHT2020
d / q / zN / ZN|	Duplicate word / all characters / first character / last character|	InlaneFreight2020|	InlaneFreight2020InlaneFreight2020 /  IInnllaanneeFFrreeiigghhtt22002200 / IInlaneFreight2020 / InlaneFreight20200
{ / }|	Rotate word left / right|	InlaneFreight2020|	nlaneFreight2020I / 0InlaneFreight202
^X / $X|	Prepend / Append character X|	InlaneFreight2020 (^! / $! )|	!InlaneFreight2020 / InlaneFreight2020!
r|	Reverse|	InlaneFreight2020|	0202thgierFenalnI

## **Rules**
`c so0 si1 se3 ss5 sa@ $2 $0 $1 $9`
*The first letter word is capitalized with the c function. Then rule uses the substitute function s to replace o with 0, i with 1, e with 3 and a with @. At the end, the year 2019 is appended to it. Copy the rule to a file so that we can debug it.*

**Create a Rule File**

    echo 'c so0 si1 se3 ss5 sa@ $2 $0 $1 $9' > rule.txt
    
**Store the Password in a File**

    echo 'password_ilfreight' > test.txt

**create the ruled passwod with hashcat**

    hashcat -r rule.txt test.txt --stdout

**Hashcat - Cracking Passwords Using Wordlists and Rules**

    hashcat -a 0 -m 100 hash /opt/useful/SecLists/Passwords/Leaked-Databases/rockyou.txt -r rule.txt

**Hashcat - Generate Random Rules**

    hashcat -a 0 -m 100 -g 1000 hash /opt/useful/SecLists/Passwords/Leaked-Databases/rockyou.txt

**pubically available rules on github**
    
    nsa-rules, Hob0Rules, corporate.rule 

# Cracking Miscellaneous Files & Hashes

## Tools 
1. HASHCAT
2. JOHN THE RIPER

### JTR installation

    sudo git clone https://github.com/magnumripper/JohnTheRipper.git
    cd JohnTheRipper/src
    sudo ./configure && make

### Cracking Password Protected Microsoft Office Documents

|**Mode**|**Target**|
|---------|--------------|
|9400|	MS Office 2007|
|9500|	MS Office 2010|
|9600|	MS Office 2013|

example

    extract hash - python office2john.py hashcat_Word_example.docx 
    crack hash - hashcat -m 9600 office_hash /opt/useful/SecLists/Passwords/Leaked-Databases/rockyou.txt

### Cracking Password Protected Zip Files

|**Mode**|	**Target**|
|----|-------|
|11600|	7-Zip|
|13600|	WinZip|
|17200|	PKZIP (Compressed)|
|17210|	PKZIP (Uncompressed)|
|17220|	PKZIP (Compressed Multi-File)|
|17225|	PKZIP (Mixed Multi-File)|
|17230|	PKZIP (Compressed Multi-File Checksum-Only)|
|23001|	SecureZIP AES-128|
|23002|	SecureZIP AES-192|
|23003|	SecureZIP AES-256|

example

    extract hash -  zip2john ~/Desktop/HTB/Academy/Cracking\ with\ Hashcat/blueprints.zip 
    crack hash- hashcat -a 0 -m 17200 pdf_hash_to_crack /opt/useful/SecLists/Passwords/Leaked-Databases/rockyou.txt

### Cracking Password Protected KeePass Files

|Mode|	Target|
|----|-------|
|13400|	KeePass 1 AES / without keyfile|
|13400|	KeePass 2 AES / without keyfile|
|13400|	KeePass 1 Twofish / with keyfile|
|13400|	Keepass 2 AES / with keyfile|

example

    extract hash -  python keepass2john.py Master.kdbx 
    crack hash - hashcat -a 0 -m 13400 keepass_hash /opt/useful/SecLists/Passwords/Leaked-Databases/rockyou.txt

###  Cracking Protected PDF Files
|Mode|	Target|
|----|-------|
|10400|	PDF 1.1 - 1.3 (Acrobat 2 - 4)|
|10410|	PDF 1.1 - 1.3 (Acrobat 2 - 4), collider #1|
|10420|	PDF 1.1 - 1.3 (Acrobat 2 - 4), collider #2|
|10500|	PDF 1.4 - 1.6 (Acrobat 5 - 8)|
|10600|	PDF 1.7 Level 3 (Acrobat 9)|
|10700|	PDF 1.7 Level 8 (Acrobat 10 - 11)|

example

    extract hash - python pdf2john.py inventory.pdf | awk -F":" '{ print $2}'
    crack hash - hashcat -a 0 -m 10500 pdf_hash /opt/useful/SecLists/Passwords/Leaked-Databases/rockyou.txt

# Cracking Wireless (WPA/WPA2) Handshakes with Hashcat
### Cracking MIC
*successfully captured a 4-way handshake with a tool such as `airodump-ng`, we need to convert it to a format that can be supplied to `Hashcat` for cracking. The format required is `hccapx`, online [cap2hashcat online](https://hashcat.net/cap2hashcat/)*
**hashcat-util install**

    git clone https://github.com/hashcat/hashcat-utils.git
    cd hashcat-utils/src
    make

**cap2hssapc syntex**

    ./cap2hccapx.bin 

**convert by cap2hashapc**
    
    ./cap2hccapx.bin corp_capture1-01.cap mic_to_crack.hccapx

**Hashcat Crack**

    hashcat -a 0 -m 22000 mic_to_crack.hccapx /opt/useful/SecLists/Passwords/Leaked-Databases/rockyou.txt

### Cracking PMKID
*extracting it from the capture (.cap) file using a tool such as `hcxpcaptool`([hcxtools GitHub repo](https://github.com/ZerBea/hcxtools)) from `hcxtools`.*

**using hcxpcaptool**

    hcxpcaptool -z pmkidhash_corp cracking_pmkid.cap 

**Cracking PMKID**

    hashcat -a 0 -m 22000 pmkidhash_corp /opt/useful/SecLists/Passwords/Leaked-Databases/rockyou.txt

**Hcxtools - Installation**
    
    git clone https://github.com/ZerBea/hcxtools.git
    cd hcxtools
    make && make install

**extract the hash**

    hcxpcapngtool cracking_pmkid.cap -o pmkidhash_corp2

