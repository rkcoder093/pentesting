IDOR vulnerabilities occur when a web application exposes a direct reference to an object, like a file or a database resource, which the end-user can directly control to obtain access to other similar objects. If any user can access any resource due to the lack of a solid access control system, the system is considered to be vulnerable.

an IDOR vulnerability mainly exists due to the lack of an access control on the back-end.

The most basic example of an IDOR vulnerability is accessing private files and resources of other users that should not be accessible to us, like personal files or credit card data, which is known as IDOR Information Disclosure Vulnerabilities.

# Identifying IDORs

**URLs and APIs**
Whenever we receive a specific file or resource, we should study the HTTP requests to look for URL parameters or APIs with an object reference (e.g. ?uid=1 or ?filename=file_1.pdf). These are mostly found in URL parameters or APIs but may also be found in other HTTP headers, like cookies.

**AJAX Call**
If we identify direct object references in the JavaScript code, we can test them for IDOR vulnerabilities.


**Understand Hashing/Encoding**

Some web applications may not use simple sequential numbers as object references but may encode the reference or hash it instead. If we find such parameters using encoded or hashed values, we may still be able to exploit them if there is no access control system on the back-end.

**Compare User Roles** (Advance)
If we want to perform more advanced IDOR attacks, we may need to register multiple users and compare their HTTP requests and object references. This may allow us to understand how the URL parameters and unique identifiers are being calculated and then calculate them for other users to gather their data.

# Mass IDOR Enumeration
Once we identify a potential IDOR, we can start testing it with basic techniques to see whether it would expose any other data. As for advanced IDOR attacks, we need to better understand how the web application works, how it calculates its object references, and how its access control system works to be able to perform advanced attacks that may not be exploitable with basic techniques.

**Exploiting IDOR vulnerability**

**1. Insecure Parameters** - where the parameter is a direct referance to the file or data.

**Bypassing Encoded References**


**IDOR in Insecure APIs**


## prevention

- we first have to build an object-level access control system and then use secure references for our objects when storing and calling them.
- use role based access mechanisim or any other access controll system.
